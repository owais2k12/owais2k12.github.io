I"Æ'<p>åœ¨Macä¸Šä½¿ç”¨iTerm2ç¡®å®è®©Linuxç»ˆç«¯æ“ä½œæ–¹ä¾¿çš„å¾ˆå¤šï¼ŒåŠ ä¸Š<a href="https://github.com/robbyrussell/oh-my-zsh">oh-my-zsh</a>è¿™ä¸ªå¼ºå¤§shellçš„åˆ©å™¨ï¼Œæ•²å‘½ä»¤å°±åƒæ»šé”®ç›˜ä¸€æ ·ã€‚</p>

<p>ä½†æ˜¯iTerm2æ²¡æœ‰å¯¹æ–‡ä»¶ä¸Šä¼ ä¸‹è½½è¿›è¡Œæ”¯æŒï¼Œè¿™ä¸ªæ˜¯è¦æ¯”secureCRTå¼±çš„åœ°æ–¹ï¼Œä¸è¿‡æˆ‘ä»¬æ€»æœ‰åŠæ³•èƒ½å¤Ÿè§£å†³ï¼Œå› ä¸ºiTerm2è¶³å¤Ÿå¼ºå¤§ï¼Œä¸‹é¢æ˜¯åˆ©ç”¨rz/szå·¥å…·æ¥å®ç°æ–‡ä»¶ä¸Šä¼ ä¸‹è½½çš„æ–¹æ³•ï¼š</p>

<p>åœ¨Macç”µè„‘ä¸Šå®‰è£…rz/szï¼š<code class="language-plaintext highlighter-rouge">brew install lrzsz</code></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/usr/bin/env bash</span>

<span class="c">#</span>
<span class="c"># iterm2-zmodem</span>
<span class="c">#</span>
<span class="c"># copyright (c) 2013 by Harald Lapp &lt;harald@octris.org&gt;</span>
<span class="c">#</span>
<span class="c"># AppleScript portion from:</span>
<span class="c"># http://stackoverflow.com/questions/4309087/cancel-button-on-osascript-in-a-bash-script</span>
<span class="c"># licensed under cc-wiki with attribution required </span>
<span class="c">#</span>

<span class="c">#</span>
<span class="c"># This script can be found at:</span>
<span class="c"># https://github.com/aurora/iterm2-zmodem</span>
<span class="c">#</span>

<span class="c">#</span>
<span class="c"># This is a re-implementation of the shell scripts "iterm2-recv-zmodem.sh" and</span>
<span class="c"># "iterm2-send-zmodem.sh" found at https://github.com/mmastrac/iterm2-zmodem</span>
<span class="c">#</span>

<span class="c"># usage</span>
<span class="k">if</span> <span class="o">[[</span> <span class="nv">$1</span> <span class="o">!=</span> <span class="s2">"sz"</span> <span class="o">&amp;&amp;</span> <span class="nv">$1</span> <span class="o">!=</span> <span class="s2">"rz"</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
    </span><span class="nb">echo</span> <span class="s2">"usage: </span><span class="nv">$0</span><span class="s2"> sz|rz"</span>
    <span class="nb">exit
</span><span class="k">fi</span>

<span class="c"># send Z-Modem cancel sequence</span>
<span class="k">function </span>cancel <span class="o">{</span>
	<span class="nb">echo</span> <span class="nt">-e</span> <span class="se">\\</span>x18<span class="se">\\</span>x18<span class="se">\\</span>x18<span class="se">\\</span>x18<span class="se">\\</span>x18
<span class="o">}</span>

<span class="c"># send notification using growlnotify</span>
<span class="k">function </span>notify <span class="o">{</span>
    <span class="nb">local </span><span class="nv">msg</span><span class="o">=</span><span class="nv">$1</span>
    
    <span class="k">if </span><span class="nb">command</span> <span class="nt">-v</span> growlnotify <span class="o">&gt;</span>/dev/null 2&gt;&amp;1<span class="p">;</span> <span class="k">then
        </span>growlnotify <span class="nt">-a</span> /Applications/iTerm.app <span class="nt">-n</span> <span class="s2">"iTerm"</span> <span class="nt">-m</span> <span class="s2">"</span><span class="nv">$msg</span><span class="s2">"</span> <span class="nt">-t</span> <span class="s2">"File transfer"</span>
    <span class="k">else
        </span><span class="nb">echo</span> <span class="s2">"# </span><span class="nv">$msg</span><span class="s2">"</span> | <span class="nb">tr</span> <span class="s1">'\n'</span> <span class="s1">' '</span>
    <span class="k">fi</span>
<span class="o">}</span>

<span class="c">#setup</span>
<span class="o">[[</span> <span class="nv">$LRZSZ_PATH</span> <span class="o">!=</span> <span class="s2">""</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nv">LRZSZ_PATH</span><span class="o">=</span><span class="s2">":</span><span class="nv">$LRZSZ_PATH</span><span class="s2">"</span> <span class="o">||</span> <span class="nv">LRZSZ_PATH</span><span class="o">=</span><span class="s2">""</span>

<span class="nv">PATH</span><span class="o">=</span><span class="si">$(</span><span class="nb">command</span> <span class="nt">-p</span> getconf PATH<span class="si">)</span>:/usr/local/bin<span class="nv">$LRZSZ_PATH</span>
<span class="nv">ZCMD</span><span class="o">=</span><span class="si">$(</span>
    <span class="k">if </span><span class="nb">command</span> <span class="nt">-v</span> <span class="nv">$1</span> <span class="o">&gt;</span>/dev/null 2&gt;&amp;1<span class="p">;</span> <span class="k">then
        </span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span>
    <span class="k">elif </span><span class="nb">command</span> <span class="nt">-v</span> l<span class="nv">$1</span> <span class="o">&gt;</span>/dev/null 2&gt;&amp;1<span class="p">;</span> <span class="k">then
        </span><span class="nb">echo</span> <span class="s2">"l</span><span class="nv">$1</span><span class="s2">"</span>
    <span class="k">fi</span>
<span class="si">)</span>

<span class="c"># main</span>
<span class="k">if</span> <span class="o">[[</span> <span class="nv">$ZCMD</span> <span class="o">=</span> <span class="s2">""</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
    </span>cancel
    <span class="nb">echo

    </span>notify <span class="s2">"Unable to find Z-Modem tools"</span>
    <span class="nb">exit
</span><span class="k">elif</span> <span class="o">[[</span> <span class="nv">$1</span> <span class="o">=</span> <span class="s2">"rz"</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    <span class="c"># receive a file</span>
    <span class="nv">DST</span><span class="o">=</span><span class="si">$(</span>
        osascript <span class="se">\</span>
            <span class="nt">-e</span> <span class="s2">"tell application </span><span class="se">\"</span><span class="s2">iTerm</span><span class="se">\"</span><span class="s2"> to activate"</span> <span class="se">\</span>
            <span class="nt">-e</span> <span class="s2">"tell application </span><span class="se">\"</span><span class="s2">iTerm</span><span class="se">\"</span><span class="s2"> to set thefile to choose folder with prompt </span><span class="se">\"</span><span class="s2">Choose a folder to place received files in</span><span class="se">\"</span><span class="s2">"</span> <span class="se">\</span>
            <span class="nt">-e</span> <span class="s2">"do shell script (</span><span class="se">\"</span><span class="s2">echo </span><span class="se">\"</span><span class="s2">&amp;(quoted form of POSIX path of thefile as Unicode text)&amp;</span><span class="se">\"\"</span><span class="s2">)"</span>
    <span class="si">)</span>
    
    <span class="k">if</span> <span class="o">[[</span> <span class="nv">$DST</span> <span class="o">=</span> <span class="s2">""</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
        </span>cancel
        <span class="nb">echo 
    </span><span class="k">fi

	</span><span class="nb">cd</span> <span class="s2">"</span><span class="nv">$DST</span><span class="s2">"</span>
	
    notify <span class="s2">"Z-Modem started receiving file"</span>

    <span class="nv">$ZCMD</span> <span class="nt">-e</span> <span class="nt">-y</span>
    <span class="nb">echo 

    </span>notify <span class="s2">"Z-Modem finished receiving file"</span>
<span class="k">else</span>
    <span class="c"># send a file</span>
    <span class="nv">SRC</span><span class="o">=</span><span class="si">$(</span>
        osascript <span class="se">\</span>
            <span class="nt">-e</span> <span class="s2">"tell application </span><span class="se">\"</span><span class="s2">iTerm</span><span class="se">\"</span><span class="s2"> to activate"</span> <span class="se">\</span>
            <span class="nt">-e</span> <span class="s2">"tell application </span><span class="se">\"</span><span class="s2">iTerm</span><span class="se">\"</span><span class="s2"> to set thefile to choose file with prompt </span><span class="se">\"</span><span class="s2">Choose a file to send</span><span class="se">\"</span><span class="s2">"</span> <span class="se">\</span>
            <span class="nt">-e</span> <span class="s2">"do shell script (</span><span class="se">\"</span><span class="s2">echo </span><span class="se">\"</span><span class="s2">&amp;(quoted form of POSIX path of thefile as Unicode text)&amp;</span><span class="se">\"\"</span><span class="s2">)"</span>
    <span class="si">)</span>

    <span class="k">if</span> <span class="o">[[</span> <span class="nv">$SRC</span> <span class="o">=</span> <span class="s2">""</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
        </span>cancel
        <span class="nb">echo 
    </span><span class="k">fi

    </span>notify <span class="s2">"Z-Modem started sending
</span><span class="nv">$SRC</span><span class="s2">"</span>

    <span class="nv">$ZCMD</span> <span class="nt">-e</span> <span class="s2">"</span><span class="nv">$SRC</span><span class="s2">"</span>
    <span class="nb">echo 

    </span>notify <span class="s2">"Z-Modem finished sending
</span><span class="nv">$SRC</span><span class="s2">"</span>
<span class="k">fi</span>
</code></pre></div></div>

<p>é¦–å…ˆå°†è¿™ä¸ªè„šæœ¬å†™åˆ°/usr/local/bin/iterm2-zmodemæ–‡ä»¶ä¸‹ï¼Œç»™å®ƒå¯æ‰§è¡Œæƒé™<code class="language-plaintext highlighter-rouge">chmod +x /usr/local/bin/iterm2/zmodem</code>ï¼Œè¿™ä¸ªè„šæœ¬æ˜¯åœ¨Linuxç»ˆç«¯ä½¿ç”¨rz/szæ—¶è°ƒç”¨çš„ï¼Œéœ€è¦ç”±iTerm2è§¦å‘ï¼Œåœ¨iTerm2-&gt;Preferencesâ€¦-&gt;Profiles-&gt;Advancedä¸‹çš„Triggersï¼Œç‚¹å‡»Editè¿›å…¥ç¼–è¾‘ã€‚åŠ å…¥å¦‚ä¸‹é…ç½®å³å¯ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Regular expression: \*\*B0100
Action:             Run Coprocess
Parameters:         /usr/local/bin/iterm2-zmodem sz

Regular expression: \*\*B00000000000000
Action:             Run Coprocess
Parameters:         /usr/local/bin/iterm2-zmodem rz
</code></pre></div></div>
<p>Githubé“¾æ¥ï¼š<a href="https://github.com/Jack614/iterm2-zmodem">https://github.com/Jack614/iterm2-zmodem</a></p>
:ET